<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>TODO for genejam • genejam</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script>




<meta property="og:title" content="TODO for genejam" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-title-body">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">genejam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.14.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/jmw86069/genejam/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>TODO for genejam</h1>
    </div>

<div id="todo-for-genejam" class="section level1">

<div id="fix-bug-when-colname-intermediate-is-supplied-as-input" class="section level2">
<h2 class="hasAnchor">
<a href="#fix-bug-when-colname-intermediate-is-supplied-as-input" class="anchor"></a>Fix bug when colname “intermediate” is supplied as input</h2>
<div id="reproducible-example-0013900-or-less" class="section level3">
<h3 class="hasAnchor">
<a href="#reproducible-example-0013900-or-less" class="anchor"></a>Reproducible example (0.0.13.900 or less)</h3>
<pre><code>idf &lt;- data.frame(Gene=c("MINA", "MINA", "GABRR3", "GABRR3"),
   intermediate=c("", "84864", "", "200959"))
idf
genejam::freshenGenes2(idf)</code></pre>
</div>
<div id="output" class="section level3">
<h3 class="hasAnchor">
<a href="#output" class="anchor"></a>Output</h3>
<pre><code>    Gene intermediate intermediate_v1 SYMBOL                                                               GENENAME
1   MINA                        84864                                                                              
2   MINA        84864           84864  RIOX2                                                  ribosomal oxygenase 2
3 GABRR3                       200959                                                                              
4 GABRR3       200959          200959 GABRR3 gamma-aminobutyric acid type A receptor rho3 subunit (gene/pseudogene)</code></pre>
<p>It creates a new column <code>"intermediate_v1"</code> then does not use it.</p>
</div>
<div id="desired-outcome" class="section level3">
<h3 class="hasAnchor">
<a href="#desired-outcome" class="anchor"></a>Desired outcome</h3>
<p>Values should be left as-is in <code>"intermediate"</code> and new values should be used to fill in holes.</p>
<p>Ideally, user can specify the <code>intermediate_colname</code> so its values are recognized, potentially skipping the first step in <code><a href="reference/freshenGenes.html">freshenGenes()</a></code> if there are no remaining colnames in the input data.</p>
<p>An argument <code>intermediate_colname</code> would make the process a bit more transparent.</p>
<p>Also, the colname <code>intermediate_colname</code> should not be split into multiple columns as is done with input data when it contains delimited values.</p>
</div>
<div id="new-workflow-version-0014900" class="section level3">
<h3 class="hasAnchor">
<a href="#new-workflow-version-0014900" class="anchor"></a>New workflow (version 0.0.14.900)</h3>
<pre><code>idf &lt;- data.frame(Gene=c("MINA", "MINA", "GABRR3", "GABRR3", "APOE"),
   ENTREZID=c("", "84864", "", "200959", "84864"))
idf
genejam::freshenGenes2(idf, intermediate="ENTREZID")
genejam::freshenGenes2(idf, intermediate="ENTREZID", handle_multiple="first_hit")
genejam::freshenGenes2(idf, intermediate="ENTREZID", handle_multiple="first_try")
genejam::freshenGenes2(idf, intermediate="ENTREZID", handle_multiple="all")
genejam::freshenGenes2(idf, intermediate="ENTREZID", handle_multiple="best_each")
genejam::freshenGenes2(idf, intermediate="ENTREZID", include_source=TRUE)</code></pre>
<p>Trickier example showing mix of input types:</p>
<pre><code>idf &lt;- data.frame(Gene=c("MINA", "RIOX2", "GABRR3", "GABRR3", "RIOX2,GABRR3", ""),
   ENTREZID=c("", "84864", "", "200959", "", "84864,200959"))
idf
genejam::freshenGenes2(idf, intermediate="ENTREZID")
genejam::freshenGenes2(idf, intermediate="ENTREZID", include_source=TRUE)</code></pre>
<p>Final example showing input with only the <code>intermediate</code> column:</p>
<pre><code>idf &lt;- data.frame(Gene=c("MINA", "RIOX2", "GABRR3", "GABRR3", "RIOX2,GABRR3", ""),
   ENTREZID=c("", "84864", "", "200959", "", "84864,200959"))
idf
genejam::freshenGenes2(idf[,"ENTREZID",drop=FALSE], intermediate="ENTREZID")</code></pre>
</div>
</div>
<div id="allow-entrezid-or-eg-as-optional-input-columns" class="section level2">
<h2 class="hasAnchor">
<a href="#allow-entrezid-or-eg-as-optional-input-columns" class="anchor"></a>Allow ENTREZID or EG as optional input column(s)</h2>
<p>I bring this issue to the top on 30mar2021.</p>
<div id="problem-space" class="section level3">
<h3 class="hasAnchor">
<a href="#problem-space" class="anchor"></a>Problem space</h3>
<p>It is not currently possible to provide ENTREZID values at input, since these values are expected to be in the <code>"intermediate"</code> column after the first step in the process. There is no annotation that takes ENTREZID and returns ENTREZID.</p>
<p>A close by-pass is to supply data with colname <code>"intermediate"</code>, which works but breaks the actual use of <code>"intermediate"</code>.</p>
<ul>
<li>Allow <code>"ENTREZID"</code> or <code>"EG"</code> as an input column, some mechanism to allow input data to have the intermediate value, without having to query an annotation.</li>
<li>It would essentially mark one or more columns with something like <code>"AsIs"</code> and the values would be delimited and used to populate the <code>"intermediate"</code> column without query.</li>
<li>There could be a special-case <code>ann_lib="ASIS"</code> that would allow values in the <code>"AsIs"</code> columns to pass through, which would give a mechanism to try querying another column first, then using the <code>"ASIS"</code> column as a secondary option.</li>
</ul>
</div>
</div>
<div id="make-searches-case-insensitive" class="section level2">
<h2 class="hasAnchor">
<a href="#make-searches-case-insensitive" class="anchor"></a>Make searches case-insensitive</h2>
<ul>
<li>This change requires something like <code>better_mget()</code> or perhaps more properly <code><a href="reference/imget.html">imget()</a></code>.</li>
<li>The basic mechanism:</li>
</ul>
<p><code>{r, imget} input &lt;- c("Apoe", "h1-3", "Hist1H1C"); keys &lt;- ls(org.Hs.egSYMBOL2EG) keymatch &lt;- match(tolower(input), tolower(keys)) keysfound &lt;- !is.na(keymatch); values &lt;- as.list(jamba::nameVector(rep(NA, length(input)), input)) valuesfound &lt;- mget(keys[keymatch[keysfound]], org.Hs.egSYMBOL2EG, ifnotfound=NA) values[keysfound] &lt;- valuesfound; values;</code></p>
<p>After some testing, it appears the slow step is retrieving all the keys, which is also performed each time the data is queried, compounding the problem.</p>
<p>Current recommendation is to use <code><a href="reference/get_anno_db.html">get_anno_db(..., ignore.case=TRUE)</a></code> which returns an environment where all keys are forced to lowercase. In this case, the environment consumes real memory, and takes longer to prepare. However once prepared, the environment can be passed directory to <code><a href="reference/freshenGenes.html">freshenGenes()</a></code> for rapid operation.</p>
<div id="suggested-mechanism" class="section level3">
<h3 class="hasAnchor">
<a href="#suggested-mechanism" class="anchor"></a>Suggested mechanism</h3>
<ul>
<li><p><code>asis_colnames=c("ENTREZID","EG")</code> would define colnames <code><a href="https://rdrr.io/r/base/c.html">c("ENTREZID","EG")</a></code> as “ASIS” which means they are not to be queried.</p></li>
<li>
<p><code>ann_lib=c("ASIS", "SYMBOL2EG", "ALIAS2EG")</code> would process in order:</p>
<ol>
<li>take all values from the <code>asis_colnames</code> and delimit them to populate the <code>"intermediate"</code> column.</li>
<li>query <code>"SYMBOL2EG"</code> using all columns except <code>asis_colnames</code>.</li>
<li>query <code>"ALIAS2EG"</code> using all columns except <code>asis_colnames</code>.</li>
</ol>
</li>
<li>
<p><code>ann_lib=c("SYMBOL2EG", "ASIS", "ALIAS2EG")</code> would process in order:</p>
<ol>
<li>query <code>"SYMBOL2EG"</code> using all columns except <code>asis_colnames</code>.</li>
<li>Populate <code>"intermediate"</code> with delimited values from the <code>asis_colnames</code> using rules defined by <code>handle_multiple</code>. That is, when <code>handle_multiple="first_try"</code> then only rows with empty values in `“intermediate” column will be populated.</li>
<li>query <code>"ALIAS2EG"</code> using all columns except <code>asis_colnames</code>.</li>
</ol>
</li>
</ul>
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>

</div>



      <footer>
      <div class="copyright">
  <p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


